[{"title":"afl++初使用","date":"2022-05-27T10:00:31.996Z","path":"2022/05/27/afl++/","text":"安装AFL++ sudo apt-get update sudo apt-get install -y build-essential python3-dev automake git flex bison libglib2.0-dev libpixman-1-dev python3-setuptools sudo apt-get install -y lld-11 llvm-11 llvm-11-dev clang-11 || sudo apt-get install -y lld llvm llvm-dev clang sudo apt-get install -y gcc-$(gcc --version|head -n1|sed &#39;s/.* //&#39;|sed &#39;s/\\..*//&#39;)-plugin-dev libstdc++-$(gcc --version|head -n1|sed &#39;s/.* //&#39;|sed &#39;s/\\..*//&#39;)-dev cd $HOME git clone https://github.com/AFLplusplus/AFLplusplus &amp;&amp; cd AFLplusplus export LLVM_CONFIG=&quot;llvm-config-11&quot; make distrib sudo make install 配置afl-clang-fast export CC=/$HOME/AFLplusplus/afl-clang-fast export CXX=/$HOME/AFLplusplus/afl-clang-fast++ export LLVM_CONFIG=&quot;llvm-config-11&quot; 下载xpdf cd $HOME mkdir fuzzing_xpdf &amp;&amp; cd fuzzing_xpdf wget https://dl.xpdfreader.com/old/xpdf-3.02.tar.gz tar -xvzf xpdf-3.02.tar.gz 编译 cd $HOME/fuzzing_xpdf/xpdf-3.02 ./configure --enable-shared=no --prefix=&quot;$HOME/fuzzing_xpdf/install/&quot; make make install 验证插桩 cd $HOME/fuzzing_xpdf/install/bin strings ./pdftotext | grep __sanitizer_cov 布置seed文件 cd $HOME/fuzzing_xpdf mkdir pdf_examples &amp;&amp; cd pdf_examples wget http://www.africau.edu/images/default/sample.pdf https://www.melbpc.org.au/wpcontent/uploads/2017/10/small-example-pdf-file.pdf hellopdf https://github.com/mozilla/pdf.js-sample-files复制获取 开始fuzz $HOME/AFLplusplus/afl-fuzz -i $HOME/fuzzing_xpdf/pdf_examples/ -o $HOME/fuzzing_xpdf/out/ -M fuzzer1 -- $HOME/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzzing_xpdf/output $HOME/AFLplusplus/afl-fuzz -i $HOME/fuzzing_xpdf/pdf_examples/ -o $HOME/fuzzing_xpdf/out/ -S fuzzer2 -- $HOME/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzzing_xpdf/output 清除之前编译的内容 rm -r $HOME/fuzzing_xpdf/install cd $HOME/fuzzing_xpdf/xpdf-3.02/ make clean GDB验证 CFLAGS=&quot;-g -O0&quot; CXXFLAGS=&quot;-g -O0&quot; ./configure --prefix=&quot;$HOME/fuzzing_xpdf/install/&quot; make make install cd $HOME/fuzzing_xpdf/install/bin gdb --args ./pdftotext $HOME/fuzzing_xpdf/out/fuzzer3/crashes/id:000001,sig:11,src:001644,time:306898,execs:119805,op:havoc,rep:8 /$HOME/fuzzing_xpdf/output run bt /backtrace 回溯执行过的函数 info registers 显示寄存器 afl++中的afl-clang-fast 和afl中的不一样，升级了。 afl++的afl-clang-fast 插桩编译的程序 用afl能跑出来 afl++2min afl20min afl++的afl-clang-fast文件能直接放到afl中使用，也可以插出更多instrumentation"},{"title":"afl初使用","date":"2022-05-26T15:07:41.636Z","path":"2022/05/26/afl使用/","text":"下载AFL sudo apt-get install gcc git make wget build-essential llvm clang cd $HOME git clone https://github.com/google/AFL.git &amp;&amp; cd AFL/ /$HOME/AFL/llvm_mode/afl-clang-fast.c ---------------131~134行------------------- #ifndef __ANDROID__ cc_params[cc_par_cnt++] = &quot;-mllvm&quot;; cc_params[cc_par_cnt++] = &quot;-sanitizer-coverage-block-threshold=0&quot;; #endif ------------------------------------------- 将这部分内容删掉，保存退出 make AFL_TRACE_PC=1 sudo make install ./afl-fuzz -V 下载xpdf cd $HOME mkdir fuzzing_xpdf &amp;&amp; cd fuzzing_xpdf wget https://dl.xpdfreader.com/old/xpdf-3.02.tar.gz tar -xvzf xpdf-3.02.tar.gz 生成afl-clang-fast cd $HOME/AFL/llvm_mode export LLVM_CONFIG=`which llvm-config` &amp;&amp; make 使用afl-clang-fast编译 cd $HOME/fuzzing_xpdf/xpdf-3.02 export CC=$HOME/AFL/afl-clang-fast export CXX=$HOME/AFL/afl-clang-fast++ ./configure --prefix=&quot;$HOME/fuzzing_xpdf/install/&quot; make make install 验证插桩 cd $HOME/fuzzing_xpdf/install/bin strings ./pdftotext | grep __sanitizer_cov *使用afl-gcc编译 cd $HOME/fuzzing_xpdf/xpdf-3.02 export CC=$HOME/AFL/afl-gcc export CXX=$HOME/AFL/afl-gcc++ ./configure --prefix=&quot;$HOME/fuzzing_xpdf/install/&quot; make make install 布置seed文件 cd $HOME/fuzzing_xpdf mkdir pdf_examples &amp;&amp; cd pdf_examples wget http://www.africau.edu/images/default/sample.pdf https://www.melbpc.org.au/wpcontent/uploads/2017/10/small-example-pdf-file.pdf hellopdf https://github.com/mozilla/pdf.js-sample-files复制获取 关闭系统的核心转储 sudo su echo core &gt;/proc/sys/kernel/core_pattern exit 开始fuzz $HOME/AFL/afl-fuzz -i $HOME/fuzzing_xpdf/pdf_examples/ -o $HOME/fuzzing_xpdf/out/ -M fuzzer1 -- $HOME/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzzing_xpdf/output $HOME/AFL/afl-fuzz -i $HOME/fuzzing_xpdf/pdf_examples/ -o $HOME/fuzzing_xpdf/out/ -S fuzzer2 -- $HOME/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzzing_xpdf/output $HOME/AFL/afl-fuzz -i $HOME/fuzzing_xpdf/pdf_examples/ -o $HOME/fuzzing_xpdf/out/ -S fuzzer3 -- $HOME/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzzing_xpdf/output $HOME/AFL/afl-fuzz -i $HOME/fuzzing_xpdf/pdf_examples/ -o $HOME/fuzzing_xpdf/out/ -S fuzzer4 -- $HOME/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzzing_xpdf/output 清除之前编译的内容 rm -r $HOME/fuzzing_xpdf/install cd $HOME/fuzzing_xpdf/xpdf-3.02/ make clean GDB验证 CFLAGS=&quot;-g -O0&quot; CXXFLAGS=&quot;-g -O0&quot; ./configure --prefix=&quot;$HOME/fuzzing_xpdf/install/&quot; make make install cd $HOME/fuzzing_xpdf/install/bin gdb --args ./pdftotext $HOME/fuzzing_xpdf/out/fuzzer2/crashes/id:000000,sig:06,src:001043,op:havoc,rep:32 /$HOME/fuzzing_xpdf/output run bt"},{"title":"soot静态分析","date":"2022-05-23T16:06:19.103Z","path":"2022/05/24/soot静态分析/","text":"数据流分析活跃变量分析常量传播分析程序间调用分析CHA指针分析"}]